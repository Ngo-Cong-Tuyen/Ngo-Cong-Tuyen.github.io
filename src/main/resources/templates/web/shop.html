<!doctype html>
<html class="no-js" lang="zxx"
      xmlns:th="https://www.thymeleaf.org"
      th:replace="~{/layout/layout :: main-fragment(
        ~{:: title},
        ~{:: #css},
        ~{:: .content},
        ~{:: #js}
      )}"
>
    <head>

        <title>Coron-shop</title>

    </head>
    <body>

    <th:block class="content">
        <!--breadcrumbs area start-->
        <div class="breadcrumbs_area">
            <div class="row">
                <div class="col-12">
                    <div class="breadcrumb_content">
                        <ul>
                            <li><a href="index.html">home</a></li>
                            <li><i class="fa fa-angle-right"></i></li>
                            <li>shop</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <!--breadcrumbs area end-->

        <!--pos home section-->
        <div class=" pos_home_section">
            <div class="row pos_home">
                <div class="col-lg-3 col-md-12">
                    <!--layere categorie"-->
                    <div class="sidebar_widget shop_c">
                        <div class="categorie__titile">
                            <h4>Categories</h4>
                        </div>
                        <div class="layere_categorie">
                            <ul>
                                <li class="nav-item dropdown " th:each="parent : ${parentCategories}">
                                    <a class="text-success " th:href="@{'/shop/page/1?sortField=name&sortDir=asc&category='+${parent.name}+'&keyword='+${keyword}}" id="navbarDropdown" role="button"
                                      th:text="${parent.name}">
                                    </a>
                                    <button class="btn  dropdown-toggle btn-sm p-0 m-0 h-50" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                                    </button>
                                    <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                                        <li th:each="category: ${categories}" th:if="${category.category!= null}">
                                            <a class="dropdown-item" th:href="@{'/shop/page/1?sortField=name&sortDir=asc&category='+${category.name}+'&keyword='+${keyword}}" th:text="${category.name}"
                                            th:if=" ${category.category.name==parent.name}">Action</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </div>

                    </div>
                    <!--layere categorie end-->

                    <!--color area start-->
                    <div class="sidebar_widget color">
                        <h2>Color</h2>
                        <div>
                            <ul>

                                <li><a th:href="@{'/shop/page/1?sortField=name&sortDir=asc&category='+${categorySearch}+'&color=black'+'&keyword='+${keyword}}"  style="color: black" >Black</a></li>

                                <li><a th:href="@{'/shop/page/1?sortField=name&sortDir=asc&category='+${categorySearch}+'&color=orange'+'&keyword='+${keyword}}" style="color: orange">Orange</a></li>

                                <li> <a th:href="@{'/shop/page/1?sortField=name&sortDir=asc&category='+${categorySearch}+'&color=blue'+'&keyword='+${keyword}}" style="color: blue">Blue</a></li>

                                <li><a th:href="@{'/shop/page/1?sortField=name&sortDir=asc&category='+${categorySearch}+'&color=yellow'+'&keyword='+${keyword}}" style="color: greenyellow">Yellow </a></li>

                                <li><a th:href="@{'/shop/page/1?sortField=name&sortDir=asc&category='+${categorySearch}+'&color=pink'+'&keyword='+${keyword}}" style="color:pink">Pink </a></li>

                                <li><a th:href="@{'/shop/page/1?sortField=name&sortDir=asc&category='+${categorySearch}+'&color=green'+'&keyword='+${keyword}}" style="color: green">Green </a></li>

                            </ul>
                        </div>
                    </div>
                    <!--color area end-->

                    <!--price slider start-->
                    <div class="sidebar_widget price">
                        <h2>Price</h2>
                        <div class="ca_search_filters">
                            <input type="text" name="text" id="amount">
                            <div id="slider-range"></div>
                        </div>
                    </div>
                    <!--price slider end-->

                    <!--wishlist block start-->
                    <div class="sidebar_widget wishlist mb-35">
                        <div class="block_title">
                            <h3><a href="/wishlist">Wishlist</a></h3>
                        </div>
                        <div class="cart_item" th:each="wish: ${wishlist}">
                            <div class="cart_img">
                                <a th:href="@{/single-product/{sku} (sku=${wish.sku})}"><img  th:src="@{'/'+ ${wish.image}}" alt=""></a>
                            </div>
                            <div class="cart_info">
                                <a th:href="@{/single-product/{sku} (sku=${wish.sku})}" th:text="${wish.productName}">lorem ipsum dolor</a>
                                <span class="cart_price" th:text="${T(com.example.coron.util.Utils).money(wish.price)}">$115.00</span>
                            </div>
                        </div>
                    </div>
                    <!--wishlist block end-->

                    <!--popular tags area-->
                    <div class="sidebar_widget tags  mb-30">
                        <div class="block_title">
                            <h3>popular tags</h3>
                        </div>
                        <div class="block_tags">
                            <a href="/shop/page/1?sortField=name&sortDir=asc&keyword=polo">polo</a>
                            <a href="/shop/page/1?sortField=name&sortDir=asc&keyword=váy">váy</a>
                            <a href="/shop/page/1?sortField=name&sortDir=asc&keyword=áo">áo</a>
                            <a href="/shop/page/1?sortField=name&sortDir=asc&keyword=quần">quần</a>
                        </div>
                    </div>
                    <!--popular tags end-->


                </div>
                <div class="col-lg-9 col-md-12">
                    <!--banner slider start-->
                    <div class="banner_slider mb-35">
                        <img src="\assets\img\banner\bannner10.jpg" alt="">
                    </div>
                    <!--banner slider start-->

                    <!--shop toolbar start-->
                    <div class="shop_toolbar mb-35">

                        <div class="list_button">
                            <ul class="nav" role="tablist">
                                <li>
                                    <a class="active" data-toggle="tab" href="#large" role="tab" aria-controls="large" aria-selected="true"><i class="fa fa-th-large"></i></a>
                                </li>
                                <li>
                                    <a data-toggle="tab" href="#list" role="tab" aria-controls="list" aria-selected="false"><i class="fa fa-th-list"></i></a>
                                </li>
                            </ul>
                        </div>

                    </div>
                    <!--shop toolbar end-->

                    <!--shop tab product-->
                    <div class="shop_tab_product">
                        <div class="tab-content" id="myTabContent">
                            <div class="tab-pane fade show active" id="large" role="tabpanel">
                                <div class="row">
                                    <div class="col-lg-4 col-md-6" th:each="product : ${products}">
                                        <div class="single_product">
                                            <div class="product_thumb">
                                                <a th:href="@{/single-product/{sku} (sku= ${product.sku})}"><img th:src="@{'/'+${product.getImages()[0].url}}" alt=""></a>
                                                <div class="img_icone">
                                                    <img src="\assets\img\cart\span-new.png" alt="">
                                                </div>
                                                <div class="product_action">
                                                    <a href="#"> <i class="fa fa-shopping-cart" ></i> Add to cart</a>
                                                </div>
                                            </div>
                                            <div class="product_content">
                                                <span class="product_price" th:text="${T(com.example.coron.util.Utils).money(product.price)}">$50.00</span>
                                                <h3 class="product_title"><a href="single-product.html" th:text="${product.name}">Curabitur sodales</a></h3>
                                            </div>
                                            <div class="product_info">
                                                <ul>
                                                    <li><a href="#" title=" Add to Wishlist " th:attr="onclick=|addToWishlist('${product.sku}')|">Add to Wishlist</a></li>
                                                    <li><a th:href="@{/single-product/{sku} (sku= ${product.sku})}">View Detail</a></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="list" role="tabpanel">
                                <div class="product_list_item mb-35" th:each="product: ${products}">
                                    <div class="row align-items-center">
                                        <div class="col-lg-4 col-md-6 col-sm-6">
                                            <div class="product_thumb">
                                                <a  th:href="@{/single-product/{sku} (sku= ${product.sku})}"><img th:src="@{'/'+${product.getImages()[0].url}}" alt=""></a>
                                                <div class="hot_img">
                                                    <img src="\assets\img\cart\span-hot.png" alt="">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-8 col-md-6 col-sm-6">
                                            <div class="list_product_content">
                                                <div class="product_ratting">
                                                    <ul>
                                                        <li><a href="#"><i class="fa fa-star"></i></a></li>
                                                        <li><a href="#"><i class="fa fa-star"></i></a></li>
                                                        <li><a href="#"><i class="fa fa-star"></i></a></li>
                                                        <li><a href="#"><i class="fa fa-star"></i></a></li>
                                                        <li><a href="#"><i class="fa fa-star"></i></a></li>
                                                    </ul>
                                                </div>
                                                <div class="list_title">
                                                    <h3><a th:href="@{/singed-product}" th:text="${product.name}">Lorem ipsum dolor</a></h3>
                                                </div>
                                                <p class="design" th:utext="${product.content}"> in quibusdam accusantium qui nostrum consequuntur, officia, quidem ut placeat. Officiis, incidunt eos recusandae! Facilis aliquam vitae blanditiis quae perferendis minus eligendi</p>

                                                <p class="compare">
                                                    <input id="select" type="checkbox">
                                                    <label for="select">Select to compare</label>
                                                </p>
                                                <div class="content_price">
                                                    <span th:text="${T(com.example.coron.util.Utils).money(product.price)}">$118.00</span>
                                                    <span class="old-price" th:text="${T(com.example.coron.util.Utils).money(product.price /0.8)}">$130.00</span>
                                                </div>
                                                <div class="add_links">
                                                    <ul>
                                                        <li><a href="#" title="add to cart"><i class="fa fa-shopping-cart" aria-hidden="true"></i></a></li>
                                                        <li><a href="#" title="add to wishlist"><i class="fa fa-heart" aria-hidden="true"></i></a></li>
                                                        <li><a href="#" data-toggle="modal" data-target="#modal_box" title="Quick view"><i class="fa fa-eye" aria-hidden="true"></i></a></li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                    <!--shop tab product end-->

                    <!--pagination style start-->
                    <div class="pagination_style">
                        <div class="page_number">
                            <span>Pages: </span>
                            <ul>
                                <li th:if="${currentPage>1}">«</li>
                                <span id="pages">
                                    <li class="current_number">1</li>
                                    <li><a href="#">2</a></li>
                                </span>
                                <li th:if="${currentPage<totalPage}">»</li>
                            </ul>
                        </div>
                    </div>
                    <!--pagination style end-->
                </div>
            </div>
        </div>
        <!--pos home section end-->
    </th:block>





    <th:block id="js">
        <script th:inline="javascript">
            const searchBarForm = document.querySelector(".search_bar form");
            const searchKeyword = document.getElementById("search-keyword");
            const pageEls= document.getElementById("pages");
            searchBarForm.attributes.action.value = "/shop/page/1";
            const keyword= [[${keyword}]];
            const totalPage = [[${totalPage}]];
            const categorySearch= [[${categorySearch}]];
            const color = [[${color}]];
            searchKeyword.value = keyword;
            function filterByCategory(categoryName){
                window.location.href= `/shop/page/1?sortField=name&sortDir=asc&category=${categoryName}&keyword=${keyword}`
            }

            console.log(totalPage);
            let html= "";
            for (let i =0;i<totalPage; i++){
                html+= `<li><a href="/shop/page/${i+1}?sortField=name&sortDir=asc&category=${categorySearch}&color=${color}&keyword=${keyword}">${i+1}</a></li>`
            }
            pageEls.innerHTML= html;
            console.log(pageEls);
            const authentication = [[${#authentication}]];
            async function addToWishlist(sku){
                try {
                    let res = await axios.post(`/api/v2/wishlist/${authentication.name}/${sku}`);
                    alert(res.data);
                } catch (e) {
                    console.log(e);
                }
            }
        </script>
    </th:block>
    </body>
</html>
